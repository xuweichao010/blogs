package com.cccloud.blogs.config.security;import com.cccloud.blogs.entity.user.Account;import com.cccloud.blogs.service.user.AccountService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.security.core.authority.SimpleGrantedAuthority;import org.springframework.security.core.userdetails.UserDetails;import org.springframework.security.core.userdetails.UserDetailsService;import org.springframework.security.core.userdetails.UsernameNotFoundException;import org.springframework.stereotype.Component;import java.util.Collections;/** * 作者：徐卫超 * 时间：2020/6/5 10:40 * 描述： 用户登录信息查询 */@Componentpublic class UserDetailServiceImpl implements UserDetailsService {    @Autowired    private AccountService accountService;    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {        Account account = accountService.findBy(null, username, null);        if (account == null) {            throw new UsernameNotFoundException("用户不存在");        }        return new IUser(account.getAccount(), account.getPassword(), Collections.singleton(new SimpleGrantedAuthority("USER")));    }}